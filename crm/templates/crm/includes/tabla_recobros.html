<div class="card border-0 shadow-sm">
    <div class="card-body p-3">
        
        <form method="get" class="row g-2 mb-4 align-items-end">
            <input type="hidden" name="tab" value="recobros">

            <div class="col-md-4">
                <label class="small fw-bold mb-1">Buscar Recobro</label>
                <div class="input-group">
                    <span class="input-group-text bg-white"><i class="fa-solid fa-search text-muted"></i></span>
                    <input type="text" name="r_q" value="{{ filtros_recobros.r_q }}" class="form-control" placeholder="Cliente, ID...">
                </div>
            </div>

            <div class="col-md-3 col-6">
                <label class="small fw-bold mb-1">Desde</label>
                <input type="date" name="r_desde" value="{{ filtros_recobros.r_desde }}" class="form-control">
            </div>

            <div class="col-md-3 col-6">
                <label class="small fw-bold mb-1">Hasta</label>
                <input type="date" name="r_hasta" value="{{ filtros_recobros.r_hasta }}" class="form-control">
            </div>

            <div class="col-md-2 d-flex gap-1">
                <button type="submit" class="btn btn-primary w-100 fw-bold">Filtrar</button>
                
                {% if filtros_recobros.r_q or filtros_recobros.r_desde %}
                <a href="?tab=recobros" class="btn btn-outline-secondary"><i class="fa-solid fa-xmark"></i></a>
                {% endif %}
            </div>
        </form>

        <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light sticky-top">
                    <tr>
                        <th class="ps-3">Fecha</th>
                        <th>Expediente</th>
                        <th>Método</th>
                        <th class="text-end">Monto</th>
                        <th class="text-center">Comp.</th>
                        <th class="text-center">Acción</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pago in recobros %}
                    <tr>
                        <td class="ps-3">{{ pago.fecha_pago|date:"d/m/Y" }}</td>
                        <td>{{ pago.expediente.deudor_nombre }}</td>
                        <td>{{ pago.metodo_pago }}</td>
                        <td class="text-end fw-bold text-success">{{ pago.monto }}€</td>
                        <td class="text-center">{% if pago.comprobante %}<i class="fa-solid fa-paperclip"></i>{% endif %}</td>
                        <td class="text-center"><a href="{% url 'crm:detalle_expediente' pago.expediente.id %}" class="btn btn-sm btn-light"><i class="fa-solid fa-eye"></i></a></td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="6" class="text-center text-muted">Sin resultados.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>