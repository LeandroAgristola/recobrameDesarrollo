{% extends 'management/layout_management.html' %}
{% load static %}

{% block content %}
<div class="container-fluid py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="d-flex align-items-center">
            <div class="bg-white p-3 rounded-circle shadow-sm border me-3 d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                <i class="fa-solid fa-briefcase text-primary fs-3"></i>
            </div>
            <div>
                <h2 class="mb-0 fw-bold text-dark">CRM: {{ empresa.nombre }}</h2>
                <span class="badge bg-primary bg-opacity-10 text-primary border border-primary">Panel de Gestión</span>
            </div>
        </div>
        <div>
            <button class="btn btn-primary fw-bold shadow-sm px-4">
                <i class="fa-solid fa-plus me-2"></i>Nuevo Expediente
            </button>
        </div>
    </div>

    <ul class="nav nav-pills mb-4 bg-white p-2 rounded shadow-sm border" id="crmTabs" role="tablist">
        <li class="nav-item">
            <button class="nav-link active fw-bold" data-bs-toggle="pill" data-bs-target="#tab-impagos">
                <i class="fa-solid fa-file-invoice-dollar me-2"></i>Impagos ({{ impagos.count }})
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link fw-bold" data-bs-toggle="pill" data-bs-target="#tab-pagados">
                <i class="fa-solid fa-circle-check text-success me-2"></i>Ha Pagado
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link fw-bold" data-bs-toggle="pill" data-bs-target="#tab-recobro">
                <i class="fa-solid fa-receipt me-2"></i>REG_recobro
            </button>
        </li>
        {% if empresa.crm_config.tiene_cedidos %}
        <li class="nav-item">
            <button class="nav-link fw-bold text-danger" data-bs-toggle="pill" data-bs-target="#tab-cedidos">
                <i class="fa-solid fa-handshake-angle me-2"></i>Cedidos
            </button>
        </li>
        {% endif %}
        <li class="nav-item ms-auto">
            <button class="nav-link fw-bold text-muted" data-bs-toggle="pill" data-bs-target="#tab-papelera">
                <i class="fa-solid fa-trash-can me-2"></i>Papelera
            </button>
        </li>
    </ul>

    <div class="tab-content bg-white p-4 rounded shadow-sm border">
        <div class="tab-pane fade show active" id="tab-impagos">
            {% include 'crm/includes/tabla_impagos.html' %}
        </div>
        
        <div class="tab-pane fade" id="tab-pagados">
            <h5 class="text-muted">Expedientes con deuda 0,00€</h5>
            </div>

        <div class="tab-pane fade" id="tab-recobro">
            {% include 'crm/includes/tabla_pagos.html' %}
        </div>

        <div class="tab-pane fade" id="tab-papelera">
            {% include 'crm/includes/tabla_papelera.html' %}
        </div>
    </div>
</div>
{% endblock %}